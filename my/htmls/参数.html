<html>
    <head>
        <meta charset="utf-8">
        <title>自定义参数</title>
    </head>
    <body>
    <h2>info参数和TB模板参数</h2>
        <p>自定义参数模块包括三个内容，来自info的参数、来自TB模板的参数和高级参数设置。来自info参数是以info.xlsx文件中的表头作为参数名称。来自TB模板的参数以是浅蓝色科目名称基础，结合灰色单元格的数量来生成参数名称。<br>若某个浅蓝科目名称下面的表格中，有两个灰色填充的单元格，则会生成“XXX科目本年”和“XXX科目上年”两个参数名称。只有一个灰色填充的单元格则只生成“XXX科目本年”。</p>
        <h2>高级参数设置</h2>
        <p>当info和TB模板中的参数不能满足我们编制模板的需要时，我们可以利用info和TB模板现有的参数，创造出新的参数。</p>
        <h3>使用方法</h3>
        <p>在自定义区域点击鼠标右键，呼出右键菜单。菜单中有四个选项：</p>
        <ul>
            <li>添加高级参数。<br></br>这个选项用于创建新的高级参数。创建一个新的高级参数需要输入：参数名称，用于判断的条件名称，以及用于比较的比较值。参数名称我们可以自己取，只要不跟info和TB里的参数名称重复就行。条件名称也是从info和TB中选取的。输入完以后，会生成三行文字。第一行，冒号前面的是我们输入的参数名称，冒号后面的是一个等式。后面两行代表等式成立或不成立时，高级参数的取值。
                </li><br>
            <li>添加子条件。当我们需要根据多个条件创建高级参数时，我们可以鼠标左键选中Ture或者False，点击添加子条件，即继续分情况判断高级参数的取值。</li><br>
            <li>设置参数值。当我们鼠标放置到True或者False上时，呼出右键菜单，点击设置参数值，就可以输入当条件成立或不成立时，高级参数的取值。<br>我们也可以通过双击True或者False来设置参数值。</li><br>
            <li>删除项目。</li>
        </ul>
    <h3>一个例子：</h3>
    <div><img src="{base_path}/statics/自定义参数.png" alt="参数" width="470" height="500"></div>
<p>我们在info中添加一个“成立年度”字段，设置了“零余额前缀”这个高级参数。这个参数表达的意思就是如果info中某只产品的成立年度等于2023，那么在生成那只产品的报告过程中，“零余额前缀”这个变量就会被自动换成“本基金于本期末无”这个表述，否则会被替换为“本基金于本期末及上年度末均无”。<br>图中的“会计年度”参数也是依此类推，只不过是多了一种情况。需要说明的是，两层条件并不一定要相同，我们完全可以成立年度、基金类型等等多种条件混搭。</p>
    <h3>注意事项：</h3>
    <p>设置完参数以后，要点保存，参数才会更新到自定义段落和自定义蓝图中去。</p>
    <br>
    <br>
    </body>
</html>